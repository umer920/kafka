[2014-09-04 11:32:59,263] INFO [ControllerEpochListener on 0]: Initialized controller epoch to 14 and zk version 13 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:32:59,304] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2014-09-04 11:32:59,603] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2014-09-04 11:32:59,628] INFO [Controller 0]: Controller 0 incremented epoch to 15 (kafka.controller.KafkaController)
[2014-09-04 11:32:59,868] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2014-09-04 11:32:59,869] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2014-09-04 11:32:59,870] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2014-09-04 11:32:59,877] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2014-09-04 11:32:59,879] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2014-09-04 11:32:59,881] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2014-09-04 11:32:59,889] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2014-09-04 11:32:59,890] INFO [Controller 0]: List of topics ineligible for deletion: test,multi2,newest,page_visits,latest,multi,new_topic (kafka.controller.KafkaController)
[2014-09-04 11:32:59,894] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2014-09-04 11:32:59,895] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2014-09-04 11:32:59,896] INFO [Controller 0]: Current list of topics in the cluster: Set(test, multi2, newest, page_visits, latest, multi, new_topic) (kafka.controller.KafkaController)
[2014-09-04 11:32:59,905] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=newest,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=2,Replica=1] -> ReplicaDeletionIneligible, [Topic=latest,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=1,Replica=1] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=newest,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=new_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=page_visits,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2014-09-04 11:32:59,925] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,934] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,943] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,953] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,960] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,968] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,978] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [new_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,988] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:32:59,996] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,003] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [latest,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,011] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [page_visits,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,018] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,026] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([multi2,2] -> OfflinePartition, [multi2,1] -> OfflinePartition, [test,0] -> OfflinePartition, [newest,1] -> OfflinePartition, [multi,0] -> OfflinePartition, [multi,2] -> OfflinePartition, [new_topic,0] -> OfflinePartition, [newest,0] -> OfflinePartition, [multi,1] -> OfflinePartition, [latest,0] -> OfflinePartition, [page_visits,0] -> OfflinePartition, [multi2,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,034] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 15 (kafka.controller.KafkaController)
[2014-09-04 11:33:00,035] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2014-09-04 11:33:00,036] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,075] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2014-09-04 11:33:00,081] DEBUG [ControllerEpochListener on 0]: Controller epoch listener fired with new epoch 15 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:33:00,084] INFO [ControllerEpochListener on 0]: Initialized controller epoch to 15 and zk version 14 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:33:00,111] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2014-09-04 11:33:00,158] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2014-09-04 11:33:00,159] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2014-09-04 11:33:00,290] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2014-09-04 11:33:00,291] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2014-09-04 11:33:00,292] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2014-09-04 11:33:00,313] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=new_topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0],[Topic=latest,Partition=0,Replica=0],[Topic=newest,Partition=0,Replica=0],[Topic=multi2,Partition=1,Replica=0],[Topic=multi,Partition=2,Replica=0],[Topic=newest,Partition=1,Replica=0],[Topic=multi,Partition=0,Replica=0],[Topic=multi,Partition=1,Replica=0],[Topic=page_visits,Partition=0,Replica=0],[Topic=multi2,Partition=2,Replica=0],[Topic=multi2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2014-09-04 11:33:00,346] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,347] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,348] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":14,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,373] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12), [multi2,1] -> (Leader:1,ISR:1,LeaderEpoch:1,ControllerEpoch:13), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [multi,2] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,379] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,1]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,379] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,1]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,380] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":2,"isr":[0]} for offline partition [multi2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,405] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [multi,2] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,415] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,2]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,415] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,2]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,416] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [multi2,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,439] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [multi,2] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,450] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,1]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,451] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,1]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,452] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [newest,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,472] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [multi,2] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,476] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,2]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,477] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,2]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,477] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [multi,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,533] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,547] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,547] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,548] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [multi,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,573] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:-1,ISR:,LeaderEpoch:10,ControllerEpoch:13), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,581] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [new_topic,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,581] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [new_topic,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,581] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":11,"isr":[0]} for offline partition [new_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,606] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:-1,ISR:,LeaderEpoch:4,ControllerEpoch:13), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,613] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,613] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,614] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [newest,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,638] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,1] -> (Leader:-1,ISR:,LeaderEpoch:2,ControllerEpoch:13), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,643] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,1]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,643] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi,1]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,644] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [multi,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,671] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,1] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [latest,0] -> (Leader:-1,ISR:,LeaderEpoch:5,ControllerEpoch:13), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,676] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [latest,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,677] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [latest,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,677] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [latest,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,706] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,1] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:15), [page_visits,0] -> (Leader:-1,ISR:,LeaderEpoch:11,ControllerEpoch:13), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,712] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [page_visits,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,713] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [page_visits,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,713] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":12,"isr":[0]} for offline partition [page_visits,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,771] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,1] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:15), [page_visits,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:15), [multi2,0] -> (Leader:1,ISR:1,LeaderEpoch:0,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:00,776] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,0]. Pick the leader from the alive assigned replicas: 0 (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,776] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,0]. Elect leader 0 from live brokers 0. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,777] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [multi2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:00,834] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,2] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15), [multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:15), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:15), [newest,1] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [multi,2] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [new_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:15), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:15), [multi,1] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:15), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:15), [page_visits,0] -> (Leader:0,ISR:0,LeaderEpoch:12,ControllerEpoch:15), [multi2,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:15)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:14,581] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2014-09-04 11:33:14,592] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2014-09-04 11:33:14,593] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2014-09-04 11:33:14,593] INFO [Controller 0]: Controller shutdown complete (kafka.controller.KafkaController)
[2014-09-04 11:33:37,115] INFO [ControllerEpochListener on 0]: Initialized controller epoch to 10 and zk version 9 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:33:37,148] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2014-09-04 11:33:37,177] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2014-09-04 11:33:37,185] INFO [Controller 0]: Controller 0 incremented epoch to 11 (kafka.controller.KafkaController)
[2014-09-04 11:33:37,357] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2014-09-04 11:33:37,358] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2014-09-04 11:33:37,358] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2014-09-04 11:33:37,363] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2014-09-04 11:33:37,364] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2014-09-04 11:33:37,365] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2014-09-04 11:33:37,371] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2014-09-04 11:33:37,372] INFO [Controller 0]: List of topics ineligible for deletion: multi2,newest,latest (kafka.controller.KafkaController)
[2014-09-04 11:33:37,375] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2014-09-04 11:33:37,375] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2014-09-04 11:33:37,376] INFO [Controller 0]: Current list of topics in the cluster: Set(newest, latest, multi2) (kafka.controller.KafkaController)
[2014-09-04 11:33:37,381] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=newest,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=latest,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=multi2,Partition=1,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2014-09-04 11:33:37,397] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,411] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [newest,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,422] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [latest,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,432] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [multi2,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,437] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([multi2,1] -> OfflinePartition, [newest,0] -> OfflinePartition, [latest,0] -> OfflinePartition, [multi2,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:37,444] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2014-09-04 11:33:37,445] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2014-09-04 11:33:37,446] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:37,466] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2014-09-04 11:33:37,484] DEBUG [ControllerEpochListener on 0]: Controller epoch listener fired with new epoch 11 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:33:37,488] INFO [ControllerEpochListener on 0]: Initialized controller epoch to 11 and zk version 10 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:33:37,491] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2014-09-04 11:33:37,528] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2014-09-04 11:33:37,529] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2014-09-04 11:33:37,535] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:localhost,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2014-09-04 11:33:37,537] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2014-09-04 11:33:37,542] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2014-09-04 11:33:37,551] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=multi2,Partition=1,Replica=0],[Topic=newest,Partition=0,Replica=0],[Topic=latest,Partition=0,Replica=0],[Topic=multi2,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2014-09-04 11:33:37,583] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [multi2,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,585] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [multi2,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,599] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:6), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:6), [multi2,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:37,608] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [newest,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,609] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [newest,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,618] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:11), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:6), [multi2,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:37,624] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [latest,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,625] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [latest,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,640] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:11), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:11), [multi2,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:33:37,650] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [multi2,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,650] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [multi2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2014-09-04 11:33:37,663] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([multi2,1] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11), [newest,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:11), [latest,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:11), [multi2,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2014-09-04 11:49:52,304] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2014-09-04 11:49:52,306] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2014-09-04 11:49:52,307] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2014-09-04 11:49:52,307] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2014-09-04 11:49:52,308] INFO [Controller 0]: Controller shutdown complete (kafka.controller.KafkaController)
[2014-09-04 11:49:52,404] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 1,0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2014-09-04 11:49:52,410] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/latest (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2014-09-04 11:49:52,415] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"1":[0,1],"2":[1,0],"0":[1,0]}} for path /brokers/topics/multi2 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2014-09-04 11:49:52,423] INFO [AddPartitionsListener on 0]: New partitions to be added Map([multi2,2] -> List(1, 0)) (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2014-09-04 11:49:52,424] INFO [Controller 0]: New partition creation callback for [multi2,2] (kafka.controller.KafkaController)
[2014-09-04 11:49:52,424] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [multi2,2] (kafka.controller.PartitionStateMachine)
[2014-09-04 11:49:52,425] ERROR [Partition state machine on Controller 0]: Error while moving some partitions to NewPartition state (kafka.controller.PartitionStateMachine)
kafka.common.StateChangeFailedException: Controller 0 epoch 11 initiated state change for partition [multi2,2] to NewPartition failed because the partition state machine has not started
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:125)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:124)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:86)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:124)
	at kafka.controller.KafkaController.onNewPartitionCreation(KafkaController.scala:471)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply$mcV$sp(PartitionStateMachine.scala:503)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.utils.Utils$.inLock(Utils.scala:538)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener.handleDataChange(PartitionStateMachine.scala:491)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:547)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2014-09-04 11:49:52,427] ERROR [AddPartitionsListener on 0]: Error while handling add partitions for data path /brokers/topics/multi2 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
java.util.NoSuchElementException: key not found: [multi2,2]
	at scala.collection.MapLike$class.default(MapLike.scala:225)
	at scala.collection.mutable.HashMap.default(HashMap.scala:45)
	at scala.collection.MapLike$class.apply(MapLike.scala:135)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:45)
	at kafka.controller.ControllerContext$$anonfun$replicasForPartition$1.apply(KafkaController.scala:109)
	at kafka.controller.ControllerContext$$anonfun$replicasForPartition$1.apply(KafkaController.scala:108)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:86)
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:233)
	at scala.collection.immutable.Set$Set1.scala$collection$SetLike$$super$map(Set.scala:73)
	at scala.collection.SetLike$class.map(SetLike.scala:93)
	at scala.collection.immutable.Set$Set1.map(Set.scala:73)
	at kafka.controller.ControllerContext.replicasForPartition(KafkaController.scala:108)
	at kafka.controller.KafkaController.onNewPartitionCreation(KafkaController.scala:472)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply$mcV$sp(PartitionStateMachine.scala:503)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.utils.Utils$.inLock(Utils.scala:538)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener.handleDataChange(PartitionStateMachine.scala:491)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:547)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2014-09-04 11:49:52,429] DEBUG [ControllerEpochListener on 0]: Controller epoch listener fired with new epoch 16 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:49:52,430] INFO [ControllerEpochListener on 0]: Initialized controller epoch to 16 and zk version 15 (kafka.controller.ControllerEpochListener)
[2014-09-04 11:49:52,431] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"1":[0],"0":[0]}} for path /brokers/topics/newest (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2014-09-04 11:49:52,437] INFO [AddPartitionsListener on 0]: New partitions to be added Map([newest,1] -> List(0)) (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2014-09-04 11:49:52,437] INFO [Controller 0]: New partition creation callback for [newest,1] (kafka.controller.KafkaController)
[2014-09-04 11:49:52,437] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [newest,1] (kafka.controller.PartitionStateMachine)
[2014-09-04 11:49:52,438] ERROR [Partition state machine on Controller 0]: Error while moving some partitions to NewPartition state (kafka.controller.PartitionStateMachine)
kafka.common.StateChangeFailedException: Controller 0 epoch 16 initiated state change for partition [newest,1] to NewPartition failed because the partition state machine has not started
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:125)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:124)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:86)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:124)
	at kafka.controller.KafkaController.onNewPartitionCreation(KafkaController.scala:471)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply$mcV$sp(PartitionStateMachine.scala:503)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.utils.Utils$.inLock(Utils.scala:538)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener.handleDataChange(PartitionStateMachine.scala:491)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:547)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2014-09-04 11:49:52,438] ERROR [AddPartitionsListener on 0]: Error while handling add partitions for data path /brokers/topics/newest (kafka.controller.PartitionStateMachine$AddPartitionsListener)
java.util.NoSuchElementException: key not found: [newest,1]
	at scala.collection.MapLike$class.default(MapLike.scala:225)
	at scala.collection.mutable.HashMap.default(HashMap.scala:45)
	at scala.collection.MapLike$class.apply(MapLike.scala:135)
	at scala.collection.mutable.HashMap.apply(HashMap.scala:45)
	at kafka.controller.ControllerContext$$anonfun$replicasForPartition$1.apply(KafkaController.scala:109)
	at kafka.controller.ControllerContext$$anonfun$replicasForPartition$1.apply(KafkaController.scala:108)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)
	at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:233)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:86)
	at scala.collection.TraversableLike$class.map(TraversableLike.scala:233)
	at scala.collection.immutable.Set$Set1.scala$collection$SetLike$$super$map(Set.scala:73)
	at scala.collection.SetLike$class.map(SetLike.scala:93)
	at scala.collection.immutable.Set$Set1.map(Set.scala:73)
	at kafka.controller.ControllerContext.replicasForPartition(KafkaController.scala:108)
	at kafka.controller.KafkaController.onNewPartitionCreation(KafkaController.scala:472)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply$mcV$sp(PartitionStateMachine.scala:503)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener$$anonfun$handleDataChange$1.apply(PartitionStateMachine.scala:492)
	at kafka.utils.Utils$.inLock(Utils.scala:538)
	at kafka.controller.PartitionStateMachine$AddPartitionsListener.handleDataChange(PartitionStateMachine.scala:491)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:547)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
